source 'https://github.com/CocoaPods/Specs.git'
use_frameworks!
platform :ios, '9.0'

target 'Toki_Tests' do
  pod 'Toki', :path => '../'

  pod 'Quick'
  pod 'Nimble'
end


LEGACY_SWIFT_PODS = %w(Mockingjay)
def set_legacy_swift(installer)
  UI.warn "#{LEGACY_SWIFT_PODS.count} pods are marked as legacy swift: #{LEGACY_SWIFT_PODS}"

  installer.pods_project.targets.select {|t| LEGACY_SWIFT_PODS.include? t.name}.each do |target|
    pod_target = installer.pod_targets.find {|t| t.name == target.name}

    unless pod_target.uses_swift?
      UI.warn "#{target.name} does not use Swift."
      next
    end

    pushed_version = pod_target.root_spec.attributes_hash['pushed_with_swift_version'].to_i
    if pushed_version >= 4
      UI.warn "#{target.name} has pushed_with_swift_version #{pushed_version}."
    end

    target.build_configurations.each do |config|
      config.build_settings['SWIFT_VERSION'] = '3.0'
    end
  end
end

post_install do |installer|
  set_legacy_swift installer
end

